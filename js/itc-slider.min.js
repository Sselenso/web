(()=>{"use strict";(
/**
 * @class ItcSlider
 * @version 1.0.0
 * @author https://github.com/itchief
 * @copyright Alexander Maltsev 2020 - 2022
 * @license MIT (https://github.com/itchief/ui-components/blob/master/LICENSE)
 * @tutorial https://itchief.ru/javascript/slider
 */
class{static#t="wrapper";static#s="items";static#e="item";static#i="item_active";static#a="indicator";static#n="indicator_active";static#r="btn_prev";static#h="btn_next";static#o="btn_hide";static#c="transition-none";static#l=[];#d;#p;constructor(t,s={},e="itc-slider__"){this.#p={prefix:e,el:t,elWrapper:t.querySelector(`.${e}${this.constructor.#t}`),elItems:t.querySelector(`.${e}${this.constructor.#s}`),elListItem:t.querySelectorAll(`.${e}${this.constructor.#e}`),btnPrev:t.querySelector(`.${e}${this.constructor.#r}`),btnNext:t.querySelector(`.${e}${this.constructor.#h}`),btnClassHide:e+this.constructor.#o,exOrderMin:0,exOrderMax:0,exItemMin:null,exItemMax:null,exTranslateMin:0,exTranslateMax:0,direction:"next",intervalId:null,isSwiping:!1,swipeX:0},this.#d={loop:!0,autoplay:!1,interval:5e3,refresh:!0,swipe:!0,...s},this.#u(),this.#m()}static getInstance(t){const s=this.#l.find((s=>s.target===t));return s?s.instance:null}static getOrCreateInstance(t,s={},e="itc-slider__"){try{const i="string"==typeof t?document.querySelector(t):t,a=this.getInstance(i);if(a)return a;const n=new this(i,s,e);return this.#l.push({target:i,instance:n}),n}catch(t){console.error(t)}}static createInstances(){document.querySelectorAll('[data-slider="itc-slider"]').forEach((t=>{const s=t.dataset,e={};Object.keys(s).forEach((t=>{if("slider"===t)return;let i=s[t];i="true"===i||i,i="false"!==i&&i,i=Number.isNaN(Number(i))?Number(i):i,e[t]=i})),this.getOrCreateInstance(t,e)}))}next(){this.#p.direction="next",this.#I()}prev(){this.#p.direction="prev",this.#I()}moveTo(t){this.#v(t)}reset(){this.#x()}dispose(){this.#f();const t=this.#p.prefix+this.constructor.#c,s=this.#p.prefix+this.constructor.#i;this.#g("stop"),this.#p.elItems.classList.add(t),this.#p.elItems.style.transform="",this.#p.elListItem.forEach((t=>{t.style.transform="",t.classList.remove(s)}));const e=`${this.#p.prefix}${this.constructor.#n}`;document.querySelectorAll(`.${e}`).forEach((t=>{t.classList.remove(e)})),this.#p.elItems.offsetHeight,this.#p.elItems.classList.remove(t);const i=this.constructor.#l.findIndex((t=>t.target===this.#p.el));this.constructor.#l.splice(i,1)}#E(t){if(!t.target.closest(".itc-slider__btn")&&!t.target.closest(".itc-slider__indicators"))return;t.preventDefault();const s=this.#p.prefix+this.constructor.#r,e=this.#p.prefix+this.constructor.#h;if(this.#g("stop"),t.target.closest(`.${s}`)||t.target.closest(`.${e}`))this.#p.direction=t.target.closest(`.${s}`)?"prev":"next",this.#I();else if(t.target.dataset.slideTo){const s=parseInt(t.target.dataset.slideTo,10);this.#v(s)}this.#d.loop&&this.#g()}#b(){this.#g("stop")}#T(){this.#g()}#_(){window.requestAnimationFrame(this.#x.bind(this))}#w(t){this.#g("stop");const s=0===t.type.search("touch")?t.touches[0]:t;this.#p.swipeX=s.clientX,this.#p.isSwiping=!0}#y(t){if(!this.#p.isSwiping)return;const s=0===t.type.search("touch")?t.changedTouches[0]:t,e=this.#p.swipeX-s.clientX;e>50?(this.#p.direction="next",this.#I()):e<-50&&(this.#p.direction="prev",this.#I()),this.#p.isSwiping=!1,this.#d.loop&&this.#g()}#L(){this.#p.isBalancing||(this.#p.isBalancing=!0,window.requestAnimationFrame(this.#M.bind(this)))}#C(){this.#p.isBalancing=!1}#N(t){t.preventDefault()}#S(){"hidden"===document.visibilityState?this.#g("stop"):"visible"===document.visibilityState&&this.#d.loop&&this.#g()}#m(){this.#p.events={click:[this.#p.el,this.#E.bind(this),!0],mouseenter:[this.#p.el,this.#b.bind(this),!0],mouseleave:[this.#p.el,this.#T.bind(this),!0],resize:[window,this.#_.bind(this),this.#d.refresh],"itc-slider__transition-start":[this.#p.elItems,this.#L.bind(this),this.#d.loop],transitionend:[this.#p.elItems,this.#C.bind(this),this.#d.loop],touchstart:[this.#p.el,this.#w.bind(this),this.#d.swipe],mousedown:[this.#p.el,this.#w.bind(this),this.#d.swipe],touchend:[document,this.#y.bind(this),this.#d.swipe],mouseup:[document,this.#y.bind(this),this.#d.swipe],dragstart:[this.#p.el,this.#N.bind(this),!0],visibilitychange:[document,this.#S.bind(this),!0]},Object.keys(this.#p.events).forEach((t=>{if(this.#p.events[t][2]){const s=this.#p.events[t][0],e=this.#p.events[t][1];s.addEventListener(t,e)}}))}#f(){Object.keys(this.#p.events).forEach((t=>{if(this.#p.events[t][2]){const s=this.#p.events[t][0],e=this.#p.events[t][1];s.removeEventListener(t,e)}}))}#g(t){if(this.#d.autoplay)return"stop"===t?(clearInterval(this.#p.intervalId),void(this.#p.intervalId=null)):void(null===this.#p.intervalId&&(this.#p.intervalId=setInterval((()=>{this.#p.direction="next",this.#I()}),this.#d.interval)))}#M(){if(!this.#p.isBalancing)return;const t=this.#p.elWrapper.getBoundingClientRect(),s=t.width/this.#p.countActiveItems/2,e=this.#p.elListItem.length;if("next"===this.#p.direction){if(this.#p.exItemMin.getBoundingClientRect().right<t.left-s){const t=this.#p.els.find((t=>t.el===this.#p.exItemMin));t.order=this.#p.exOrderMin+e;const s=this.#p.exTranslateMin+e*this.#p.width;t.translate=s,this.#p.exItemMin.style.transform=`translate3D(${s}px, 0px, 0.1px)`,this.#A()}}else{if(this.#p.exItemMax.getBoundingClientRect().left>t.right+s){const t=this.#p.els.find((t=>t.el===this.#p.exItemMax));t.order=this.#p.exOrderMax-e;const s=this.#p.exTranslateMax-e*this.#p.width;t.translate=s,this.#p.exItemMax.style.transform=`translate3D(${s}px, 0px, 0.1px)`,this.#A()}}window.requestAnimationFrame(this.#M.bind(this))}#O(){const t=this.#p.prefix+this.constructor.#i;this.#p.activeItems.forEach(((s,e)=>{s?this.#p.elListItem[e].classList.add(t):this.#p.elListItem[e].classList.remove(t);const i=this.#p.el.querySelectorAll(`.${this.#p.prefix}${this.constructor.#a}`);i.length&&s?i[e].classList.add(`${this.#p.prefix}${this.constructor.#n}`):i.length&&!s&&i[e].classList.remove(`${this.#p.prefix}${this.constructor.#n}`)}))}#I(){const t="next"===this.#p.direction?-this.#p.width:this.#p.width,s=this.#p.translate+t;if(!this.#d.loop){const t=this.#p.width*(this.#p.elListItem.length-this.#p.countActiveItems);if(s<-t||s>0)return;this.#p.btnPrev&&(this.#p.btnPrev.classList.remove(this.#p.btnClassHide),this.#p.btnNext.classList.remove(this.#p.btnClassHide)),this.#p.btnPrev&&s===-t?this.#p.btnNext.classList.add(this.#p.btnClassHide):this.#p.btnPrev&&0===s&&this.#p.btnPrev.classList.add(this.#p.btnClassHide)}"next"===this.#p.direction?this.#p.activeItems=[...this.#p.activeItems.slice(-1),...this.#p.activeItems.slice(0,-1)]:this.#p.activeItems=[...this.#p.activeItems.slice(1),...this.#p.activeItems.slice(0,1)],this.#O(),this.#p.translate=s,this.#p.elItems.style.transform=`translate3D(${s}px, 0px, 0.1px)`,this.#p.elItems.dispatchEvent(new CustomEvent("itc-slider__transition-start",{bubbles:!0}))}#v(t){const s=this.#p.activeItems.reduce(((s,e,i)=>{const a=e?t-i:s;return Math.abs(a)<Math.abs(s)?a:s}),this.#p.activeItems.length);if(0!==s){this.#p.direction=s>0?"next":"prev";for(let t=0;t<Math.abs(s);t++)this.#I()}}#u(){this.#p.els=[],this.#p.translate=0,this.#p.activeItems=[],this.#p.isBalancing=!1;const t=parseFloat(getComputedStyle(this.#p.elItems).gap);this.#p.width=this.#p.elListItem[0].getBoundingClientRect().width+t;const s=this.#p.elWrapper.getBoundingClientRect().width;if(this.#p.countActiveItems=Math.round(s/this.#p.width),this.#p.elListItem.forEach(((t,s)=>{t.style.transform="",this.#p.activeItems.push(s<this.#p.countActiveItems?1:0),this.#p.els.push({el:t,index:s,order:s,translate:0})})),this.#d.loop){const t=this.#p.elListItem.length-1,s=-(t+1)*this.#p.width;this.#p.elListItem[t].style.transform=`translate3D(${s}px, 0px, 0.1px)`,this.#p.els[t].order=-1,this.#p.els[t].translate=s,this.#A()}else this.#p.btnPrev&&this.#p.btnPrev.classList.add(this.#p.btnClassHide);this.#O(),this.#g()}#x(){const t=this.#p.prefix+this.constructor.#c,s=parseFloat(getComputedStyle(this.#p.elItems).gap),e=this.#p.elListItem[0].getBoundingClientRect().width+s,i=this.#p.elWrapper.getBoundingClientRect().width,a=Math.round(i/e);e===this.#p.width&&a===this.#p.countActiveItems||(this.#g("stop"),this.#p.elItems.classList.add(t),this.#p.elItems.style.transform="translate3D(0px, 0px, 0.1px)",this.#u(),window.requestAnimationFrame((()=>{this.#p.elItems.classList.remove(t)})))}#A(){const t=this.#p.els.map((t=>t.el)),s=this.#p.els.map((t=>t.order));this.#p.exOrderMin=Math.min(...s),this.#p.exOrderMax=Math.max(...s);const e=s.indexOf(this.#p.exOrderMin),i=s.indexOf(this.#p.exOrderMax);this.#p.exItemMin=t[e],this.#p.exItemMax=t[i],this.#p.exTranslateMin=this.#p.els[e].translate,this.#p.exTranslateMax=this.#p.els[i].translate}}).createInstances()})();